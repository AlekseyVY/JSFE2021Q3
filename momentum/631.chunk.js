(()=>{let e,t=null;self.onmessage=l=>{e=l.data;const h=r(e);"github"===e.source&&o(h),"unsplash"===e.source&&n(h),"flickr"===e.source&&a(h),t?(clearInterval(t),s(e)):s(e)};const s=e=>{const s=r(e);"github"===e.source&&(t=setInterval((()=>{e.num=Math.floor(20*Math.random())+1;const t=r(e);o(t)}),1e4)),"unsplash"===e.source&&(t=setInterval((()=>n(s)),1e4)),"flickr"===e.source&&(t=setInterval((()=>a(s)),1e4))},o=t=>{fetch(t).then((e=>e.blob())).then((t=>{postMessage({blob:t,num:e.num})}))},n=t=>{fetch(t).then((e=>e.json())).then((t=>{fetch(t.urls.regular).then((e=>e.blob())).then((t=>{postMessage({blob:t,num:e.num})}))}))},a=t=>{fetch(t).then((e=>e.json())).then((t=>{fetch(t.photos.photo[Math.floor(Math.random()*t.photos.photo.length)].url_l).then((e=>e.blob())).then((t=>{postMessage({blob:t,num:e.num})}))}))},r=e=>{let t=null;const s=e.num<10?`0${e.num}`:e.num,o=(new Date).toLocaleTimeString("ru-RU",{hour12:!1}),[n]=String(o).split(":");return n>=6&&n<=11&&(t="morning"),n>=12&&n<=17&&(t="afternoon"),n>=18&&n<=23&&(t="evening"),n>=0&&n<=5&&(t="night"),"github"===e.source?`https://raw.githubusercontent.com/AlekseyVY/stage1-tasks/assets/images/${t}/${s}.jpg`:"unsplash"===e.source?`https://api.unsplash.com/photos/random?orientation=landscape&query=${t}&query=${e.tag}&client_id=x3eswxPzWXmGDQU4DxczZ4dGoyhUSiyaHKKMJeaP-Fg`:"flickr"===e.source?`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=b5246e42907fad07311adb9365d8934b&tag_mode=all&tags=${t},${e.tag}&extras=url_l&format=json&nojsoncallback=1`:void 0}})();